<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Listing 10.5 - Animating an element to the click point with vectors</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body,
        html {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        .chaser {
            position: absolute;
            width: 30px;
            height: 30px;
            background: hsl(84 74% 44%);
            border-radius: 50%;
            transform: translate(0, 0);
            will-change: transform;
        }
    </style>
</head>

<body>
    <div class="chaser"></div>

    <script>
        class Vector2 {
            constructor(x = 0, y = 0) {
                this.x = x;
                this.y = y;
            }

            add(vector) {
                return new Vector2(this.x + vector.x, this.y + vector.y);
            }

            subtract(vector) {
                return new Vector2(this.x - vector.x, this.y - vector.y);
            }

            multiply(scalar) {
                return new Vector2(this.x * scalar, this.y * scalar);
            }

            magnitude() {
                return Math.hypot(this.x, this.y);
            }

            normalize() {
                const m = this.magnitude();
                return m > 0
                    ? new Vector2(this.x / m, this.y / m)
                    : new Vector2(0, 0);
            }
            clone() {
                return new Vector2(this.x, this.y);
            }

            toCSSTranslate() {
                return `translate(${this.x}px, ${this.y}px)`;
            }
        }

        // Initialize the chaser position
        const chaserEl = document.querySelector('.chaser');
        let position = new Vector2(50, 50);
        chaserEl.style.transform = position.toCSSTranslate();
        let target;

        // On click, set new target
        document.addEventListener('click', e => {
            target = new Vector2(e.clientX - 15, e.clientY - 15);
            animate();
        });

        // Move 10px per frame toward target
        const SPEED = 10;

        function animate() {
            const toTarget = target.subtract(position);
            const dist = toTarget.magnitude();

            if (dist > SPEED) {
                // Move SPEED pixels toward the target
                const step = toTarget.normalize().multiply(SPEED);
                position = position.add(step);
                chaserEl.style.transform = position.toCSSTranslate();
                requestAnimationFrame(animate);
            } else if (dist > 0) {
                // Snap exactly to the target
                position = target.clone();
                chaserEl.style.transform = position.toCSSTranslate();
            }
        }

    </script>
</body>

</html>